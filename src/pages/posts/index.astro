---
import { Button } from '@/components/ui/button'

import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts'
import { getCollection } from 'astro:content'
import Layout from '@/layouts/Layout.astro'
import { formatDate } from '@/lib/utils'

const nav = ['posts']

const posts = (await getCollection('posts')).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
)
---

<Layout title={SITE_TITLE} description={SITE_DESCRIPTION}>
  <main>
    <section>
      <h1 class="text-[2.5rem] text-[#f2f2f2] mb-8">All Posts</h1>
      <ul class="posts-grid">
        {
          posts.map((post) => (
            <li>
              <a href={`/posts/${post.slug}/`} class="post-link">
                <h4 class="title text-[#f2f2f2]">{post.data.title}</h4>
                <p class="text-[#b2b2b2] mt-2 text-sm">{formatDate(post.data.date)}</p>
                <p class="description text-[#b2b2b2] mt-3">{post.data.description}</p>
              </a>
            </li>
          ))
        }
      </ul>
    </section>
  </main>
</Layout>

<style>
  .posts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .post-link {
    display: block;
    padding: 1.5rem;
    border-radius: 8px;
    background-color: #1a1b23;
    height: 100%;
    transition:
      transform 0.2s ease,
      box-shadow 0.2s ease;
  }

  .post-link:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }

  .title {
    font-size: 1.5rem;
    margin: 0;
    line-height: 1.3;
  }

  .description {
    font-size: 1rem;
    line-height: 1.6;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
  }

  @media (max-width: 768px) {
    .posts-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
